KARMA PLAYER SETUP
==================

AI-powered music search with intelligent album matching and quality ranking.

1. Install:
   pip install karma_player-0.1.1-py3-none-any.whl

2. Initialize:
   poetry run karma-player init

   When prompted, enter:

   a) MusicBrainz API key (REQUIRED):
      - Go to: https://musicbrainz.org/account/applications
      - Register/login, create new app
      - Type: Installed
      - Callback URI: Leave empty
      - Copy the key and paste it here

   b) Music directory:
      - Press Enter for default (~/Music)

   c) Jackett (REQUIRED for torrent search):
      - Run locally: http://localhost:9117 (see README for setup)
      - Or request remote access from team (see README)

3. Enable AI Features (REQUIRED):
   Set ONE of these API keys (auto-detected):

   # Anthropic Claude (recommended - best quality, ~$0.01/search)
   export ANTHROPIC_API_KEY="sk-ant-..."

   # OpenAI GPT (fastest, most economical, ~$0.005/search)
   export OPENAI_API_KEY="sk-..."

   # Google Gemini (good balance, ~$0.003/search)
   export GEMINI_API_KEY="..."

   Auto-detection priority: Anthropic > OpenAI > Gemini

   ‚ö†Ô∏è  FREE ALTERNATIVE: Ollama (NOT RECOMMENDED)
   ------------------------------------------------
   Ollama is FREE but VERY SLOW (30-60s per search vs <2s for cloud).
   Only use if you can't afford cloud AI (~$15/month for 100 searches/day).

   # Install: https://ollama.ai
   brew install ollama && ollama pull llama3.2

   # Enable explicitly (opt-in):
   export OLLAMA_MODEL="llama3.2"

   Ollama is disabled by default due to poor interactive performance.

   Add to ~/.bashrc or ~/.zshrc for persistence:
   echo 'export ANTHROPIC_API_KEY="your-key"' >> ~/.bashrc

4. Search Examples:

   # Basic search (AI-powered, best quality any format)
   poetry run karma-player search "I know you know - Esperanza Spalding"

   # Prefer FLAC, fallback to best available
   poetry run karma-player search "radiohead ok computer" --format FLAC

   # ONLY FLAC (strict, no fallback)
   poetry run karma-player search "pink floyd dark side" --format FLAC --strict

   # Regional music (any format, FLAC may not exist)
   poetry run karma-player search "edson gomes camelo" --min-seeders 1

   # Fast search (skip MusicBrainz)
   poetry run karma-player search "miles davis" --skip-musicbrainz --min-seeders 1

Common Options:
   --format FLAC          Prefer FLAC, fallback to MP3 if none found
   --format * (default)   Best quality any format
   --strict               ONLY exact format, no fallback
   --min-seeders 5        Minimum seeders (default: 1)
   --profile remote       Use remote/local/hybrid Jackett
   --skip-musicbrainz     Direct search (faster, less accurate)

Environment Variables:
   KARMA_PLAYER_NO_SPLASH=1    Disable splash screen (cleaner output)

   AI Configuration (auto-detected, priority order):
     ANTHROPIC_API_KEY            Anthropic Claude API key (priority 1)
     OPENAI_API_KEY               OpenAI GPT API key (priority 2)
     GEMINI_API_KEY               Google Gemini API key (priority 3)

     Ollama (FREE but SLOW, opt-in only):
       OLLAMA_MODEL=llama3.2        Enables Ollama (disabled by default)
       OLLAMA_API_BASE=http://...   Custom URL (default: localhost:11434)

   Examples:
   KARMA_PLAYER_NO_SPLASH=1 poetry run karma-player search "miles davis"
   ANTHROPIC_API_KEY="sk-ant-..." poetry run karma-player search "radiohead"

What the AI Does:
- Parses your query to extract artist, song, album
- Searches MusicBrainz for canonical metadata
- Queries 18+ torrent indexers via Jackett
- FILTERS to correct album first
- RANKS by quality (24-bit > 16-bit, FLAC > MP3)
- Explains its decision with reasoning

Example Output:
   ü§ñ AI Decision
   ‚îî‚îÄ Selected: Esperanza Spalding - Esperanza (2008) [FLAC 16/44]

   üí≠ Reasoning:
      Selected the correct album 'Esperanza' containing the song
      'I Know You Know'. Although 16-bit, it matches the requested
      album.

   ‚ùå Rejected:
      ‚Ä¢ "12 Little Spells" (24-bit) - Wrong album, doesn't contain song
      ‚Ä¢ "Radio Music Society" (24-bit) - Different album

Done!
